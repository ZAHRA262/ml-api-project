from flask import Flask, request, jsonify
import numpy as np
import tensorflow as tf
from tensorflow.keras.models import load_model

app = Flask(__name__)

model = load_model('model.h5')

@app.route('/predict', methods=['POST'])
def predict():
    data = request.json['data']
    data = np.array(data).reshape(1, 48, 522)  # adapte cette forme si besoin
    prediction = model.predict(data)
    return jsonify({'prediction': prediction.tolist()})


